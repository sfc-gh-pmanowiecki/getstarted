
<!doctype html>

<html>
<head>
  <meta name="description" content="mBank Snowflake Database Quickstart Guide - Learn essential Snowflake concepts and operations">
  <meta name="keywords" content="mBank, Snowflake, Database, SQL, Data Warehouse, Tutorial">
  <meta name="author" content="mBank Technical Team">
  <meta property="og:title" content="mBank Snowflake Database Quickstart">
  <meta property="og:description" content="Comprehensive guide to Snowflake database operations for mBank developers">
  <meta property="og:image" content="./mBank_logo.png">
  <link rel="icon" type="image/png" href="./mBank_logo.png">
  <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">
  <meta name="theme-color" content="#4F7DC9">
  <meta charset="UTF-8">
  <title>mBank Snowflake Database Quickstart</title>
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Source+Code+Pro:400|Roboto:400,300,400italic,500,700|Roboto+Mono">
  <link rel="stylesheet" href="//fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="stylesheet" href="https://storage.googleapis.com/claat-public/codelab-elements.css">
  <style>
    .success {
      color: #1e8e3e;
    }
    .error {
      color: red;
    }
  </style>
  <link rel="stylesheet" href="mbank-styles.css">
</head>
<body>
  <google-codelab-analytics gaid="UA-49880327-14"></google-codelab-analytics>
  <google-codelab codelab-gaid=""
                  id="snowflake-quickstart"
                  title="Snowflake Database Quickstart"
                  environment="web"
                  feedback-link="https://github.com/sfc-gh-pmanowiecki/getstarted">
    
      <google-codelab-step label="Introduction" duration="2">
        <h2 class="checklist" is-upgraded>What You&#39;ll Learn</h2>
<p>W tym quickstarcie nauczysz siƒô podstawowych koncept√≥w i operacji w Snowflake, kt√≥re sƒÖ kluczowe dla pracy z bazami danych w ≈õrodowisku mBank.</p>
<p><strong>Tematy, kt√≥re om√≥wimy:</strong></p>
<ul>
<li>Database Objects and Commands</li>
<li>Objects and Tables</li>
<li>Constraints and Views</li>
<li>System Functions</li>
<li>External and Dynamic Tables</li>
<li>Monitoring i optymalizacja</li>
</ul>
<h2 is-upgraded>Prerequisites</h2>
<ul>
<li>Dostƒôp do Snowflake</li>
<li>Podstawowa znajomo≈õƒá SQL</li>
<li>Uprawnienia do tworzenia obiekt√≥w w bazie danych</li>
</ul>
<h2 is-upgraded>üì• Kompletny skrypt SQL</h2>
<p>Wszystkie polecenia SQL z tego quickstartu sƒÖ dostƒôpne w jednym pliku: <a href="./mbank-snowflake-quickstart-complete.sql" target="_blank"><strong>üìÅ mbank-snowflake-quickstart-complete.sql</strong></a></p>
<p>Mo≈ºesz pobraƒá ten plik i wykonywaƒá polecenia sekcja po sekcji, lub skopiowaƒá i wkleiƒá poszczeg√≥lne fragmenty do swojego ≈õrodowiska Snowflake.</p>


      </google-codelab-step>
    
      <google-codelab-step label="Database Objects and Commands" duration="5">
        <h2 is-upgraded>PrzeglƒÖd obiekt√≥w bazodanowych</h2>
<p>W Snowflake g≈Ç√≥wne obiekty bazodanowe to:</p>
<ul>
<li><strong>Databases</strong> - kontener najwy≈ºszego poziomu</li>
<li><strong>Schemas</strong> - logiczne grupowanie obiekt√≥w</li>
<li><strong>Tables</strong> - struktura przechowywania danych</li>
<li><strong>Views</strong> - wirtualne tabele</li>
<li><strong>Functions</strong> - programowalne obiekty</li>
</ul>
<h2 is-upgraded>Podstawowe komendy</h2>
<pre><code language="language-sql" class="language-sql">-- Tworzenie bazy danych
CREATE DATABASE MBANK_DEMO;

-- U≈ºywanie bazy danych
USE DATABASE MBANK_DEMO;

-- Tworzenie schematu
CREATE SCHEMA QUICKSTART_SCHEMA;

-- U≈ºywanie schematu
USE SCHEMA QUICKSTART_SCHEMA;
</code></pre>
<h2 is-upgraded>ƒÜwiczenie praktyczne</h2>
<p>Wykonaj poni≈ºsze komendy w swojej sesji Snowflake:</p>
<pre><code language="language-sql" class="language-sql">-- Sprawdzenie dostƒôpnych baz danych
SHOW DATABASES;

-- Sprawdzenie schemat√≥w
SHOW SCHEMAS;
</code></pre>
<h2 is-upgraded>üìö Dodatkowe zasoby</h2>
<ul>
<li><a href="https://docs.snowflake.com/en/sql-reference/ddl-database" target="_blank">Database Objects Overview</a></li>
<li><a href="https://docs.snowflake.com/en/sql-reference/ddl-schema" target="_blank">Schema Management</a></li>
<li><a href="https://docs.snowflake.com/en/sql-reference/sql-all" target="_blank">SQL Commands Reference</a></li>
</ul>


      </google-codelab-step>
    
      <google-codelab-step label="Tables" duration="8">
        <h2 is-upgraded>Tworzenie tabel</h2>
<pre><code language="language-sql" class="language-sql">-- Podstawowa tabela
CREATE TABLE MBANK_CUSTOMERS (
    CUSTOMER_ID NUMBER(10,0),
    FIRST_NAME VARCHAR(50),
    LAST_NAME VARCHAR(50), 
    EMAIL VARCHAR(100),
    PHONE_NUMBER VARCHAR(20),
    CREATED_DATE TIMESTAMP_NTZ DEFAULT CURRENT_TIMESTAMP()
);
</code></pre>
<h2 is-upgraded>Typy danych w Snowflake</h2>
<ul>
<li><strong>NUMBER</strong> - liczby ca≈Çkowite i dziesiƒôtne</li>
<li><strong>VARCHAR</strong> - tekst o zmiennej d≈Çugo≈õci</li>
<li><strong>TIMESTAMP_NTZ</strong> - znacznik czasu bez strefy czasowej</li>
<li><strong>BOOLEAN</strong> - warto≈õci true/false</li>
<li><strong>VARIANT</strong> - dane JSON/semi-strukturalne</li>
</ul>
<h2 is-upgraded>Wstawianie danych</h2>
<pre><code language="language-sql" class="language-sql">INSERT INTO MBANK_CUSTOMERS 
(CUSTOMER_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER)
VALUES 
(1, &#39;Jan&#39;, &#39;Kowalski&#39;, &#39;jan.kowalski@example.com&#39;, &#39;+48123456789&#39;),
(2, &#39;Anna&#39;, &#39;Nowak&#39;, &#39;anna.nowak@example.com&#39;, &#39;+48987654321&#39;);
</code></pre>
<h2 is-upgraded>ƒÜwiczenie</h2>
<p>Stw√≥rz tabelƒô <code>MBANK_ACCOUNTS</code> z kolumnami:</p>
<ul>
<li>ACCOUNT_ID (NUMBER)</li>
<li>CUSTOMER_ID (NUMBER)</li>
<li>ACCOUNT_TYPE (VARCHAR)</li>
<li>BALANCE (NUMBER(15,2))</li>
<li>CREATED_DATE (TIMESTAMP_NTZ)</li>
</ul>
<h2 is-upgraded>üìö Dodatkowe zasoby</h2>
<ul>
<li><a href="https://docs.snowflake.com/en/sql-reference/sql/create-table" target="_blank">CREATE TABLE</a></li>
<li><a href="https://docs.snowflake.com/en/sql-reference/data-types" target="_blank">Data Types</a></li>
<li><a href="https://docs.snowflake.com/en/sql-reference/sql/insert" target="_blank">INSERT Statement</a></li>
<li><a href="https://docs.snowflake.com/en/user-guide/tables-intro" target="_blank">Working with Tables</a></li>
</ul>


      </google-codelab-step>
    
      <google-codelab-step label="Objects" duration="4">
        <h2 is-upgraded>ZarzƒÖdzanie obiektami</h2>
<p>Snowflake oferuje bogate mo≈ºliwo≈õci zarzƒÖdzania obiektami bazodanowymi.</p>
<h2 is-upgraded>Informacje o obiektach</h2>
<pre><code language="language-sql" class="language-sql">-- Opis tabeli MBANK_CUSTOMERS
DESCRIBE TABLE MBANK_CUSTOMERS;

-- Lista wszystkich tabel
SHOW TABLES;

-- Informacje o kolumnach w tabeli MBANK_CUSTOMERS
SHOW COLUMNS IN TABLE MBANK_CUSTOMERS;

-- Informacje o tabeli MBANK_ACCOUNTS (je≈õli zosta≈Ça stworzona)
DESCRIBE TABLE MBANK_ACCOUNTS;
</code></pre>
<h2 is-upgraded>Uprawnienia</h2>
<pre><code language="language-sql" class="language-sql">-- Przyznawanie uprawnie≈Ñ do tabeli MBANK_CUSTOMERS
GRANT SELECT ON TABLE MBANK_CUSTOMERS TO ROLE PUBLIC;

-- Sprawdzanie uprawnie≈Ñ do tabeli MBANK_CUSTOMERS
SHOW GRANTS ON TABLE MBANK_CUSTOMERS;

-- Przyznawanie uprawnie≈Ñ do tabeli MBANK_ACCOUNTS
GRANT SELECT ON TABLE MBANK_ACCOUNTS TO ROLE PUBLIC;
</code></pre>
<h2 is-upgraded>üìö Dodatkowe zasoby</h2>
<ul>
<li><a href="https://docs.snowflake.com/en/sql-reference/sql/desc-table" target="_blank">DESCRIBE Command</a></li>
<li><a href="https://docs.snowflake.com/en/sql-reference/sql/show" target="_blank">SHOW Commands</a></li>
<li><a href="https://docs.snowflake.com/en/user-guide/security-access-control-overview" target="_blank">Access Control</a></li>
<li><a href="https://docs.snowflake.com/en/sql-reference/sql/grant-privilege" target="_blank">GRANT Privileges</a></li>
</ul>


      </google-codelab-step>
    
      <google-codelab-step label="Constraints" duration="6">
        <h2 is-upgraded>Obs≈Çugiwane typy ogranicze≈Ñ w Snowflake</h2>
<p>Snowflake obs≈Çuguje tylko nastƒôpujƒÖce typy ogranicze≈Ñ zgodnie ze standardem ANSI SQL:</p>
<ul>
<li><strong>PRIMARY KEY</strong> - klucz g≈Ç√≥wny</li>
<li><strong>FOREIGN KEY</strong> - klucz obcy</li>
<li><strong>UNIQUE</strong> - unikatowo≈õƒá warto≈õci</li>
<li><strong>NOT NULL</strong> - wymagana warto≈õƒá (nie null)</li>
</ul>
<h2 is-upgraded>Wa≈ºne ograniczenia funkcjonalno≈õci</h2>
<p><strong>Dla standardowych tabel:</strong></p>
<ul>
<li>Ograniczenia sƒÖ <strong>zdefiniowane ale NIE egzekwowane</strong> (opr√≥cz NOT NULL)</li>
<li>S≈Çu≈ºƒÖ g≈Ç√≥wnie do cel√≥w dokumentacji i kompatybilno≈õci z narzƒôdziami BI</li>
<li>Zapewnienie integralno≈õci danych jest odpowiedzialno≈õciƒÖ aplikacji</li>
</ul>
<p><strong>Dla tabel hybrydowych:</strong></p>
<ul>
<li>Wszystkie ograniczenia sƒÖ w pe≈Çni egzekwowane</li>
<li>PRIMARY KEY jest wymagany</li>
</ul>
<h2 is-upgraded>Przyk≈Çady implementacji</h2>
<pre><code language="language-sql" class="language-sql">-- Primary Key - zawsze NOT NULL i UNIQUE
CREATE TABLE MBANK_PRODUCTS (
    PRODUCT_ID NUMBER(10,0) PRIMARY KEY,
    PRODUCT_NAME VARCHAR(100) NOT NULL,
    PRODUCT_TYPE VARCHAR(50),
    PRICE NUMBER(10,2)
);

-- Foreign Key
ALTER TABLE MBANK_ACCOUNTS 
ADD CONSTRAINT FK_CUSTOMER 
FOREIGN KEY (CUSTOMER_ID) 
REFERENCES MBANK_CUSTOMERS(CUSTOMER_ID);

-- Unique constraint
ALTER TABLE MBANK_CUSTOMERS 
ADD CONSTRAINT UK_EMAIL UNIQUE (EMAIL);

-- Not Null constraint
ALTER TABLE MBANK_CUSTOMERS 
ALTER COLUMN EMAIL SET NOT NULL;
</code></pre>
<h2 is-upgraded>Sprawdzanie ogranicze≈Ñ</h2>
<pre><code language="language-sql" class="language-sql">-- Informacje o ograniczeniach
SELECT 
    CONSTRAINT_NAME,
    TABLE_NAME,
    CONSTRAINT_TYPE,
    ENFORCED
FROM INFORMATION_SCHEMA.TABLE_CONSTRAINTS
WHERE TABLE_SCHEMA = &#39;QUICKSTART_SCHEMA&#39;;
</code></pre>
<h2 is-upgraded>üìö Dodatkowe zasoby</h2>
<ul>
<li><a href="https://docs.snowflake.com/en/sql-reference/constraints-overview" target="_blank">Constraints Overview</a></li>
<li><a href="https://docs.snowflake.com/en/sql-reference/sql/create-table-constraint" target="_blank">CREATE TABLE CONSTRAINT</a></li>
<li><a href="https://docs.snowflake.com/en/sql-reference/info-schema/table_constraints" target="_blank">Table Constraints Information Schema</a></li>
<li><a href="https://docs.snowflake.com/en/user-guide/table-considerations#referential-integrity-constraints" target="_blank">Referential Integrity</a></li>
</ul>


      </google-codelab-step>
    
      <google-codelab-step label="Views" duration="5">
        <h2 is-upgraded>Tworzenie widok√≥w</h2>
<pre><code language="language-sql" class="language-sql">-- Podstawowy widok
CREATE VIEW CUSTOMER_SUMMARY AS
SELECT 
    c.CUSTOMER_ID,
    c.FIRST_NAME || &#39; &#39; || c.LAST_NAME AS FULL_NAME,
    c.EMAIL,
    COUNT(a.ACCOUNT_ID) AS ACCOUNT_COUNT,
    SUM(a.BALANCE) AS TOTAL_BALANCE
FROM MBANK_CUSTOMERS c
LEFT JOIN MBANK_ACCOUNTS a ON c.CUSTOMER_ID = a.CUSTOMER_ID
GROUP BY c.CUSTOMER_ID, c.FIRST_NAME, c.LAST_NAME, c.EMAIL;
</code></pre>
<h2 is-upgraded>Secure Views</h2>
<pre><code language="language-sql" class="language-sql">-- Bezpieczny widok (ukrywa definicjƒô)
CREATE SECURE VIEW SENSITIVE_CUSTOMER_DATA AS
SELECT 
    CUSTOMER_ID,
    FIRST_NAME,
    SUBSTR(EMAIL, 1, 3) || &#39;***&#39; AS MASKED_EMAIL
FROM MBANK_CUSTOMERS;
</code></pre>
<h2 is-upgraded>Materialized Views</h2>
<pre><code language="language-sql" class="language-sql">-- Zmaterializowany widok dla wydajno≈õci
CREATE MATERIALIZED VIEW DAILY_ACCOUNT_SUMMARY AS
SELECT 
    DATE_TRUNC(&#39;DAY&#39;, CREATED_DATE) AS ACCOUNT_DATE,
    ACCOUNT_TYPE,
    COUNT(*) AS ACCOUNT_COUNT,
    AVG(BALANCE) AS AVG_BALANCE
FROM MBANK_ACCOUNTS
GROUP BY DATE_TRUNC(&#39;DAY&#39;, CREATED_DATE), ACCOUNT_TYPE;
</code></pre>
<h2 is-upgraded>üìö Dodatkowe zasoby</h2>
<ul>
<li><a href="https://docs.snowflake.com/en/sql-reference/sql/create-view" target="_blank">CREATE VIEW</a></li>
<li><a href="https://docs.snowflake.com/en/user-guide/views-secure" target="_blank">Secure Views</a></li>
<li><a href="https://docs.snowflake.com/en/user-guide/views-materialized" target="_blank">Materialized Views</a></li>
<li><a href="https://docs.snowflake.com/en/user-guide/views-introduction" target="_blank">Working with Views</a></li>
</ul>


      </google-codelab-step>
    
      <google-codelab-step label="Using the Result_Scan Function" duration="4">
        <h2 is-upgraded>Funkcja RESULT_SCAN</h2>
<p>RESULT_SCAN pozwala na wykorzystanie wynik√≥w poprzedniego zapytania:</p>
<pre><code language="language-sql" class="language-sql">-- Pierwsze zapytanie
SELECT CUSTOMER_ID, TOTAL_BALANCE 
FROM CUSTOMER_SUMMARY 
WHERE TOTAL_BALANCE &gt; 10000;

-- Wykorzystanie wynik√≥w poprzedniego zapytania
SELECT AVG(TOTAL_BALANCE) AS AVG_HIGH_BALANCE
FROM TABLE(RESULT_SCAN(LAST_QUERY_ID()));
</code></pre>
<h2 is-upgraded>Praktyczne zastosowanie</h2>
<pre><code language="language-sql" class="language-sql">-- Zapytanie z identyfikatorem
SELECT QUERY_ID, QUERY_TEXT 
FROM TABLE(INFORMATION_SCHEMA.QUERY_HISTORY()) 
WHERE QUERY_TEXT ILIKE &#39;%MBANK_CUSTOMERS%&#39; 
LIMIT 5;

-- U≈ºycie konkretnego ID zapytania
SELECT * FROM TABLE(RESULT_SCAN(&#39;01234567-89ab-cdef-ghij-klmnopqrstuv&#39;));
</code></pre>
<h2 is-upgraded>üìö Dodatkowe zasoby</h2>
<ul>
<li><a href="https://docs.snowflake.com/en/sql-reference/functions/result_scan" target="_blank">RESULT_SCAN Function</a></li>
<li><a href="https://docs.snowflake.com/en/user-guide/ui-history" target="_blank">Query History</a></li>
<li><a href="https://docs.snowflake.com/en/sql-reference/info-schema" target="_blank">Information Schema</a></li>
</ul>


      </google-codelab-step>
    
      <google-codelab-step label="System Functions" duration="6">
        <h2 is-upgraded>Funkcje informacyjne</h2>
<pre><code language="language-sql" class="language-sql">-- Aktualna wersja Snowflake
SELECT CURRENT_VERSION();

-- Aktualny u≈ºytkownik i rola
SELECT CURRENT_USER(), CURRENT_ROLE();

-- Aktualny warehouse i baza danych
SELECT CURRENT_WAREHOUSE(), CURRENT_DATABASE();
</code></pre>
<h2 is-upgraded>Funkcje czasowe</h2>
<pre><code language="language-sql" class="language-sql">-- Aktualna data i czas
SELECT 
    CURRENT_TIMESTAMP() AS CURRENT_TS,
    CURRENT_DATE() AS CURRENT_DATE,
    CURRENT_TIME() AS CURRENT_TIME;

-- Operacje na datach
SELECT 
    DATEADD(&#39;day&#39;, 30, CURRENT_DATE()) AS FUTURE_DATE,
    DATEDIFF(&#39;day&#39;, &#39;2024-01-01&#39;, CURRENT_DATE()) AS DAYS_SINCE_NY;
</code></pre>
<h2 is-upgraded>Funkcje konwersji</h2>
<pre><code language="language-sql" class="language-sql">-- Konwersje typ√≥w
SELECT 
    TO_NUMBER(&#39;123.45&#39;) AS NUM_VALUE,
    TO_DATE(&#39;2024-01-15&#39;, &#39;YYYY-MM-DD&#39;) AS DATE_VALUE,
    TO_VARCHAR(CURRENT_DATE(), &#39;YYYY-MM-DD&#39;) AS STRING_DATE;
</code></pre>
<h2 is-upgraded>üìö Dodatkowe zasoby</h2>
<ul>
<li><a href="https://docs.snowflake.com/en/sql-reference/functions-system" target="_blank">System Functions</a></li>
<li><a href="https://docs.snowflake.com/en/sql-reference/functions-date-time" target="_blank">Date and Time Functions</a></li>
<li><a href="https://docs.snowflake.com/en/sql-reference/functions-conversion" target="_blank">Conversion Functions</a></li>
<li><a href="https://docs.snowflake.com/en/sql-reference/functions/current_user" target="_blank">Context Functions</a></li>
</ul>


      </google-codelab-step>
    
      <google-codelab-step label="External Tables" duration="7">
        <h2 is-upgraded>Tworzenie External Table</h2>
<pre><code language="language-sql" class="language-sql">-- Tworzenie stage dla zewnƒôtrznych danych
CREATE OR REPLACE STAGE MBANK_EXTERNAL_STAGE
URL = &#39;s3://mbank-data-bucket/customer-data/&#39;
CREDENTIALS = (AWS_KEY_ID = &#39;your-key&#39; AWS_SECRET_KEY = &#39;your-secret&#39;);

-- External table dla plik√≥w CSV
CREATE OR REPLACE EXTERNAL TABLE MBANK_EXTERNAL_CUSTOMERS (
    CUSTOMER_ID NUMBER AS (VALUE:c1::NUMBER),
    FIRST_NAME VARCHAR AS (VALUE:c2::VARCHAR),
    LAST_NAME VARCHAR AS (VALUE:c3::VARCHAR),
    EMAIL VARCHAR AS (VALUE:c4::VARCHAR)
)
LOCATION = @MBANK_EXTERNAL_STAGE
FILE_FORMAT = (TYPE = &#39;CSV&#39; SKIP_HEADER = 1);
</code></pre>
<h2 is-upgraded>Zapytania do External Tables</h2>
<pre><code language="language-sql" class="language-sql">-- Podstawowe zapytanie
SELECT * FROM MBANK_EXTERNAL_CUSTOMERS LIMIT 10;

-- Filtrowanie
SELECT FIRST_NAME, LAST_NAME 
FROM MBANK_EXTERNAL_CUSTOMERS 
WHERE EMAIL LIKE &#39;%@mbank.pl&#39;;
</code></pre>
<h2 is-upgraded>Refresh External Tables</h2>
<pre><code language="language-sql" class="language-sql">-- Od≈õwie≈ºenie metadanych
ALTER EXTERNAL TABLE MBANK_EXTERNAL_CUSTOMERS REFRESH;

-- Sprawdzenie statusu
SELECT * FROM TABLE(INFORMATION_SCHEMA.EXTERNAL_TABLE_FILES(
    TABLE_NAME =&gt; &#39;MBANK_EXTERNAL_CUSTOMERS&#39;
));
</code></pre>
<h2 is-upgraded>üìö Dodatkowe zasoby</h2>
<ul>
<li><a href="https://docs.snowflake.com/en/user-guide/tables-external-intro" target="_blank">External Tables</a></li>
<li><a href="https://docs.snowflake.com/en/sql-reference/sql/create-external-table" target="_blank">CREATE EXTERNAL TABLE</a></li>
<li><a href="https://docs.snowflake.com/en/sql-reference/sql/create-file-format" target="_blank">File Formats</a></li>
<li><a href="https://docs.snowflake.com/en/user-guide/data-load-considerations-stage" target="_blank">Stages</a></li>
</ul>


      </google-codelab-step>
    
      <google-codelab-step label="Dynamic Tables" duration="8">
        <h2 is-upgraded>Tworzenie Dynamic Tables</h2>
<pre><code language="language-sql" class="language-sql">-- Dynamic table z automatycznym od≈õwie≈ºaniem
CREATE OR REPLACE DYNAMIC TABLE MBANK_CUSTOMER_METRICS
TARGET_LAG = &#39;1 hour&#39;
WAREHOUSE = COMPUTE_WH
AS
SELECT 
    DATE_TRUNC(&#39;hour&#39;, CREATED_DATE) AS HOUR_PERIOD,
    COUNT(*) AS NEW_CUSTOMERS,
    COUNT(DISTINCT CUSTOMER_ID) AS UNIQUE_CUSTOMERS
FROM MBANK_CUSTOMERS
GROUP BY DATE_TRUNC(&#39;hour&#39;, CREATED_DATE);
</code></pre>
<h2 is-upgraded>Konfiguracja od≈õwie≈ºania</h2>
<pre><code language="language-sql" class="language-sql">-- Dynamic table z r√≥≈ºnymi opcjami LAG
CREATE OR REPLACE DYNAMIC TABLE MBANK_ACCOUNT_SUMMARY
TARGET_LAG = &#39;15 minutes&#39;
WAREHOUSE = COMPUTE_WH
AS
SELECT 
    ACCOUNT_TYPE,
    COUNT(*) AS ACCOUNT_COUNT,
    SUM(BALANCE) AS TOTAL_BALANCE,
    AVG(BALANCE) AS AVG_BALANCE,
    MAX(BALANCE) AS MAX_BALANCE
FROM MBANK_ACCOUNTS
GROUP BY ACCOUNT_TYPE;
</code></pre>
<h2 is-upgraded>Z≈Ço≈ºone Dynamic Tables</h2>
<pre><code language="language-sql" class="language-sql">-- Dynamic table z join&#39;ami
CREATE OR REPLACE DYNAMIC TABLE MBANK_CUSTOMER_ACCOUNT_VIEW
TARGET_LAG = &#39;30 minutes&#39;
WAREHOUSE = COMPUTE_WH
AS
SELECT 
    c.CUSTOMER_ID,
    c.FIRST_NAME || &#39; &#39; || c.LAST_NAME AS FULL_NAME,
    a.ACCOUNT_TYPE,
    a.BALANCE,
    CASE 
        WHEN a.BALANCE &gt;= 100000 THEN &#39;VIP&#39;
        WHEN a.BALANCE &gt;= 50000 THEN &#39;PREMIUM&#39;
        ELSE &#39;STANDARD&#39;
    END AS CUSTOMER_TIER
FROM MBANK_CUSTOMERS c
JOIN MBANK_ACCOUNTS a ON c.CUSTOMER_ID = a.CUSTOMER_ID;
</code></pre>
<h2 is-upgraded>üìö Dodatkowe zasoby</h2>
<ul>
<li><a href="https://docs.snowflake.com/en/user-guide/dynamic-tables-about" target="_blank">Dynamic Tables</a></li>
<li><a href="https://docs.snowflake.com/en/sql-reference/sql/create-dynamic-table" target="_blank">CREATE DYNAMIC TABLE</a></li>
<li><a href="https://docs.snowflake.com/en/user-guide/dynamic-tables-best-practices" target="_blank">Dynamic Tables Best Practices</a></li>
<li><a href="https://docs.snowflake.com/en/user-guide/dynamic-tables-refresh" target="_blank">Refresh Modes</a></li>
</ul>


      </google-codelab-step>
    
      <google-codelab-step label="Dynamic Table Advantages" duration="5">
        <h2 is-upgraded>Korzy≈õci z Dynamic Tables</h2>
<p><strong>1. Automatyczne od≈õwie≈ºanie</strong></p>
<ul>
<li>Dane zawsze aktualne bez manualnej interwencji</li>
<li>Optymalizacja koszt√≥w przez inteligentne od≈õwie≈ºanie</li>
</ul>
<p><strong>2. Wydajno≈õƒá</strong></p>
<ul>
<li>Materializowane wyniki dla szybkich zapyta≈Ñ</li>
<li>Incremental processing</li>
</ul>
<p><strong>3. Prostota zarzƒÖdzania</strong></p>
<ul>
<li>Automatyczne zarzƒÖdzanie cyklem ≈ºycia</li>
<li>Brak potrzeby tworzenia scheduled jobs</li>
</ul>
<h2 is-upgraded>Por√≥wnanie z tradycyjnymi rozwiƒÖzaniami</h2>
<pre><code language="language-sql" class="language-sql">-- Tradycyjne podej≈õcie - scheduled task
CREATE OR REPLACE TASK REFRESH_SUMMARY_TASK
WAREHOUSE = COMPUTE_WH
SCHEDULE = &#39;60 MINUTE&#39;
AS
INSERT OVERWRITE INTO CUSTOMER_SUMMARY_TABLE 
SELECT ...;

-- Dynamic Table - automatyczne
CREATE OR REPLACE DYNAMIC TABLE CUSTOMER_SUMMARY_DT
TARGET_LAG = &#39;1 hour&#39;
WAREHOUSE = COMPUTE_WH
AS
SELECT ...;
</code></pre>
<h2 is-upgraded>Best Practices</h2>
<ul>
<li>U≈ºywaj odpowiedniego TARGET_LAG dla potrzeb biznesowych</li>
<li>Monitoruj koszty warehouse</li>
<li>Optymalizuj zapytania bazowe</li>
<li>Wykorzystuj partycjonowanie gdzie to mo≈ºliwe</li>
</ul>
<h2 is-upgraded>üìö Dodatkowe zasoby</h2>
<ul>
<li><a href="https://docs.snowflake.com/en/user-guide/dynamic-tables-tasks-create" target="_blank">Dynamic Tables Performance</a></li>
<li><a href="https://docs.snowflake.com/en/user-guide/cost-understanding-compute" target="_blank">Cost Optimization</a></li>
<li><a href="https://docs.snowflake.com/en/user-guide/dynamic-tables-comparison-tasks" target="_blank">Comparing Dynamic Tables vs Tasks</a></li>
<li><a href="https://docs.snowflake.com/en/user-guide/dynamic-tables-incremental" target="_blank">Incremental Processing</a></li>
</ul>


      </google-codelab-step>
    
      <google-codelab-step label="Monitoring Dynamic Tables" duration="6">
        <h2 is-upgraded>Sprawdzanie statusu Dynamic Tables</h2>
<pre><code language="language-sql" class="language-sql">-- Status wszystkich dynamic tables
SHOW DYNAMIC TABLES;

-- Szczeg√≥≈Çowe informacje
SELECT 
    NAME,
    DATABASE_NAME,
    SCHEMA_NAME,
    TARGET_LAG,
    WAREHOUSE,
    REFRESH_MODE,
    LAST_DATA_TIMESTAMP
FROM TABLE(INFORMATION_SCHEMA.DYNAMIC_TABLES());
</code></pre>
<h2 is-upgraded>Historia od≈õwie≈ºania</h2>
<pre><code language="language-sql" class="language-sql">-- Historia od≈õwie≈ºania Dynamic Table
SELECT 
    TABLE_NAME,
    REFRESH_START_TIME,
    REFRESH_END_TIME,
    REFRESH_TRIGGER,
    BYTES_PROCESSED,
    ROWS_PRODUCED
FROM TABLE(INFORMATION_SCHEMA.DYNAMIC_TABLE_REFRESH_HISTORY(
    &#39;MBANK_CUSTOMER_METRICS&#39;
))
ORDER BY REFRESH_START_TIME DESC;
</code></pre>
<h2 is-upgraded>Metryki wydajno≈õci</h2>
<pre><code language="language-sql" class="language-sql">-- Analiza koszt√≥w i wydajno≈õci
SELECT 
    DATE_TRUNC(&#39;day&#39;, REFRESH_START_TIME) AS REFRESH_DATE,
    COUNT(*) AS REFRESH_COUNT,
    SUM(BYTES_PROCESSED) AS TOTAL_BYTES,
    AVG(DATEDIFF(&#39;second&#39;, REFRESH_START_TIME, REFRESH_END_TIME)) AS AVG_DURATION_SEC
FROM TABLE(INFORMATION_SCHEMA.DYNAMIC_TABLE_REFRESH_HISTORY(
    &#39;MBANK_CUSTOMER_METRICS&#39;
))
WHERE REFRESH_START_TIME &gt;= DATEADD(&#39;day&#39;, -7, CURRENT_TIMESTAMP())
GROUP BY DATE_TRUNC(&#39;day&#39;, REFRESH_START_TIME)
ORDER BY REFRESH_DATE;
</code></pre>
<h2 is-upgraded>Alerting i monitoring</h2>
<pre><code language="language-sql" class="language-sql">-- Sprawdzenie op√≥≈∫nie≈Ñ w od≈õwie≈ºaniu
SELECT 
    NAME,
    TARGET_LAG,
    DATEDIFF(&#39;minute&#39;, LAST_DATA_TIMESTAMP, CURRENT_TIMESTAMP()) AS ACTUAL_LAG_MINUTES
FROM TABLE(INFORMATION_SCHEMA.DYNAMIC_TABLES())
WHERE DATEDIFF(&#39;minute&#39;, LAST_DATA_TIMESTAMP, CURRENT_TIMESTAMP()) &gt; 
      EXTRACT(MINUTE FROM TARGET_LAG) * 2;
</code></pre>
<h2 is-upgraded>üìö Dodatkowe zasoby</h2>
<ul>
<li><a href="https://docs.snowflake.com/en/user-guide/dynamic-tables-refresh-history" target="_blank">Monitoring Dynamic Tables</a></li>
<li><a href="https://docs.snowflake.com/en/sql-reference/info-schema#dynamic-table-functions" target="_blank">Information Schema Views</a></li>
<li><a href="https://docs.snowflake.com/en/user-guide/ui-query-profile" target="_blank">Query Performance Optimization</a></li>
<li><a href="https://docs.snowflake.com/en/user-guide/cost-understanding-overall" target="_blank">Cost Monitoring</a></li>
</ul>


      </google-codelab-step>
    
      <google-codelab-step label="Conclusion" duration="2">
        <h2 is-upgraded>Podsumowanie</h2>
<p>Gratulacje! Uko≈Ñczy≈Çe≈õ mBank Snowflake Database Quickstart. Teraz znasz:</p>
<p>‚úÖ <strong>Database Objects and Commands</strong> - podstawowe obiekty i komendy ‚úÖ <strong>Objects i Tables</strong> - zarzƒÖdzanie tabelami i obiektami<br> ‚úÖ <strong>Constraints i Views</strong> - ograniczenia i widoki ‚úÖ <strong>System Functions</strong> - funkcje systemowe Snowflake ‚úÖ <strong>External Tables</strong> - integracja z zewnƒôtrznymi ≈∫r√≥d≈Çami danych ‚úÖ <strong>Dynamic Tables</strong> - automatycznie od≈õwie≈ºane tabele ‚úÖ <strong>Monitoring</strong> - ≈õledzenie wydajno≈õci i koszt√≥w</p>
<h2 is-upgraded>Nastƒôpne kroki</h2>
<ol type="1">
<li>Eksploruj zaawansowane funkcje Snowflake</li>
<li>Zaimplementuj rozwiƒÖzania w swoim ≈õrodowisku</li>
<li>Zoptymalizuj wydajno≈õƒá zapyta≈Ñ</li>
<li>Skonfiguruj monitoring i alerting</li>
</ol>
<h2 is-upgraded>Dodatkowe zasoby</h2>
<ul>
<li><a href="https://docs.snowflake.com/" target="_blank">Snowflake Documentation</a></li>
<li><a href="https://mbank-tech-docs.internal" target="_blank">mBank Technical Guidelines</a></li>
<li><a href="https://best-practices.mbank.internal" target="_blank">SQL Best Practices</a></li>
</ul>
<p>Dziƒôkujemy za uczestnictwo w mBank Snowflake Quickstart! üéâ</p>


      </google-codelab-step>
    
  </google-codelab>

  <script src="https://storage.googleapis.com/claat-public/native-shim.js"></script>
  <script src="https://storage.googleapis.com/claat-public/custom-elements.min.js"></script>
  <script src="https://storage.googleapis.com/claat-public/prettify.js"></script>
  <script src="https://storage.googleapis.com/claat-public/codelab-elements.js"></script>
  <script src="//support.google.com/inapp/api.js"></script>

</body>
</html>
